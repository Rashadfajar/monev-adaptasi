<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Beranda</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>

<div class="appbar">
  <div class="topbar">
    <div class="inner">
      <div class="brand">
        <div class="badge" aria-hidden="true"></div>
        <div>
          <b>Dashboard MoNEv Adaptasi</b>
          <!-- <small class="muted">Ringkas • Drill-down sektoral & kewilayahan</small> -->
        </div>
      </div>

      <div class="userbox">
        <div class="searchbox">
          <span class="sicon" aria-hidden="true">⌕</span>
          <input id="globalSearch" type="search" placeholder="Cari sektor, wilayah, indikator, aksi..." />
        </div>

        <button class="helpbtn" id="helpBtn" type="button" title="Bantuan">?</button>

        <!-- <span class="userchip">Periode: 2024</span> -->
        <span class="avatar" title="User"></span>
      </div>
    </div>
  </div>

  <div class="tabbar">
    <div class="inner tabrow">
      <div class="pagehead">
        <h1>Beranda</h1>
        <div class="sub">Ringkasan nasional untuk memulai eksplorasi.</div>
      </div>

      
      <nav class="menu menu-right">
        <a href="index.html" class="active">Beranda</a>

        <div class="dd">
          <button class="dd-btn" type="button">Horizontal ▾</button>
          <div class="dd-menu">
            <a href="horizontal.html" class="">Dashboard Horizontal</a>
            <a href="horizontal_guideline.html" class="">Guideline Horizontal</a>
          </div>
        </div>

        <div class="dd">
          <button class="dd-btn" type="button">Vertikal ▾</button>
          <div class="dd-menu">
            <a href="vertical.html" class="">Dashboard Vertikal</a>
            <a href="vertical_guideline.html" class="">Guideline Vertikal</a>
          </div>
        </div>

        <div class="dd">
          <button class="dd-btn" type="button">Impact ▾</button>
          <div class="dd-menu">
            <a href="impact.html" class="">Dashboard Impact</a>
            <a href="impact_assessment.html" class="">Impact Assessment</a>
          </div>
        </div>

        <a href="aksi_pembiayaan.html" class="">Aksi &amp; Pembiayaan</a>
        <a href="pelaporan.html" class="">Pelaporan</a>
      </nav>
    </div>
  </div>
</div>

<div class="wrap">
  <section class="grid">

    <!-- KPI -->
    <div class="card span-3">
      <div class="bd kpi2">
        <div class="kpi-top">
          <div class="kpi-title">Aksi teregistrasi</div>
          <span class="chip mini">SRN</span>
        </div>
        <div class="kpi-main">1.245</div>
        <div class="kpi-foot">
          <span class="delta up">+6,2%</span>
          <span class="muted">vs periode sebelumnya</span>
        </div>
      </div>
    </div>

    <div class="card span-3">
      <div class="bd kpi2">
        <div class="kpi-top">
          <div class="kpi-title">Indikator terlapor</div>
          <span class="chip mini">Lamp. III</span>
        </div>
        <div class="kpi-main">48</div>
        <div class="kpi-foot">
          <span class="delta flat">stabil</span>
          <span class="muted">konsolidasi nasional</span>
        </div>
      </div>
    </div>

    <div class="card span-3">
      <div class="bd kpi2">
        <div class="kpi-top">
          <div class="kpi-title">Aksi bertag CBT</div>
          <span class="chip mini">Pembiayaan</span>
        </div>
        <div class="kpi-main">612</div>
        <div class="kpi-foot">
          <span class="delta up">+3,1%</span>
          <span class="muted">pelabelan meningkat</span>
        </div>
      </div>
    </div>

    <div class="card span-3">
      <div class="bd kpi2">
        <div class="kpi-top">
          <div class="kpi-title">Kelengkapan data</div>
          <span class="chip mini">QA/QC</span>
        </div>
        <div class="kpi-main">91%</div>
        <div class="kpi-foot">
          <span class="delta down">-1,0%</span>
          <span class="muted">butuh review metadata</span>
        </div>
      </div>
    </div>

    <!-- Tren -->
    <div class="card span-7">
      <div class="hd">
        <div>
          <div class="h">Tren Ringkas Nasional</div>
          <div class="s">Aksi teregistrasi dan status pelabelan pembiayaan.</div>
        </div>
        <span class="pill">2023–2025</span>
      </div>
      <div class="bd">
        <canvas id="trendMain" width="900" height="320"></canvas>

        <div class="legend">
          <span><i class="dot a"></i> Aksi teregistrasi</span>
          <span><i class="dot b"></i> Aksi bertag CBT</span>
        </div>

        <div class="insight">
          <b>Insight singkat:</b> pertumbuhan registrasi konsisten, namun cakupan CBT masih perlu diperluas pada aksi lintas sektor.
        </div>
      </div>
    </div>

    <!-- Status & perhatian -->
    <div class="card span-5">
      <div class="hd">
        <div>
          <div class="h">Status Cepat</div>
          <div class="s">Ringkas pelaporan dan kualitas data.</div>
        </div>
        <span class="pill">Hari ini</span>
      </div>
      <div class="bd">
        <div class="statgrid">
          <div class="statbox">
            <div class="muted">Siap ekspor</div>
            <div class="statval">BTR / NC</div>
            <div class="tag good">Ready</div>
          </div>
          <div class="statbox">
            <div class="muted">Isu validasi</div>
            <div class="statval">47</div>
            <div class="tag warn">Review</div>
          </div>
          <div class="statbox">
            <div class="muted">Wilayah aktif</div>
            <div class="statval">34</div>
            <div class="tag">Provinsi</div>
          </div>
        </div>

        <div class="mini-bars">
          <div class="barrow">
            <div class="barlabel">Good</div>
            <div class="bar"><span style="width:72%"></span></div>
            <div class="barnum">120</div>
          </div>
          <div class="barrow">
            <div class="barlabel">Warn</div>
            <div class="bar warn"><span style="width:22%"></span></div>
            <div class="barnum">37</div>
          </div>
          <div class="barrow">
            <div class="barlabel">Bad</div>
            <div class="bar bad"><span style="width:6%"></span></div>
            <div class="barnum">10</div>
          </div>
        </div>

        <ul class="bullets">
          <li><b>Metadata dokumen rujukan</b> perlu dilengkapi pada beberapa sektor.</li>
          <li><b>Tag CBT</b> belum merata pada aksi lintas sektor.</li>
        </ul>
      </div>
    </div>

    <!-- Akses cepat -->
    <div class="card span-12">
      <div class="hd">
        <div>
          <div class="h">Akses Cepat</div>
          <div class="s">Masuk ke halaman detail dengan pratinjau ringkas.</div>
        </div>
        <span class="pill">Shortcut</span>
      </div>

      <div class="bd">
        <div class="grid quickgrid">

          <!-- Sektoral -->
          <a class="qcard span-4" href="horizontal.html">
            <div class="qhd">
              <div class="qt">Sektoral</div>
              <div class="qs">Per sektor • capaian & kualitas data</div>
            </div>
            <canvas class="qviz" id="qSektor" width="420" height="120"></canvas>
            <div class="qmeta">
              <span class="chip">Top sektor: Air</span>
              <span class="chip">QC: Good dominan</span>
            </div>
          </a>

          <!-- Kewilayahan -->
          <a class="qcard span-4" href="vertical.html">
            <div class="qhd">
              <div class="qt">Kewilayahan</div>
              <div class="qs">Provinsi/kab-kota • tren & gap</div>
            </div>
            <div class="qmap" aria-hidden="true"></div>
            <div class="qmeta">
              <span class="chip">34 provinsi</span>
              <span class="chip">5 perlu review</span>
            </div>
          </a>

          <!-- Impact/Outcome -->
          <a class="qcard span-4" href="impact.html">
            <div class="qhd">
              <div class="qt">Impact / Outcome</div>
              <div class="qs">Sinyal indikator • tanpa klaim kausal</div>
            </div>
            <canvas class="qviz" id="qImpact" width="420" height="120"></canvas>
            <div class="qmeta">
              <span class="chip">Indikator: 48</span>
              <span class="chip">Sinyal: campuran</span>
            </div>
          </a>

          <!-- Aksi & Pembiayaan -->
          <a class="qcard span-6" href="aksi_pembiayaan.html">
            <div class="qhd">
              <div class="qt">Aksi & Pembiayaan</div>
              <div class="qs">Jejak aksi → CBT → AKSARA → SRN</div>
            </div>
            <canvas class="qviz" id="qFin" width="520" height="120"></canvas>
            <div class="qmeta">
              <span class="chip">CBT tagged: 612</span>
              <span class="chip">Gap: lintas sektor</span>
            </div>
          </a>

          <!-- Pelaporan -->
          <a class="qcard span-6" href="pelaporan.html">
            <div class="qhd">
              <div class="qt">Pelaporan</div>
              <div class="qs">Ekspor • versioning • audit trail</div>
            </div>
            <canvas class="qviz" id="qReport" width="520" height="120"></canvas>
            <div class="qmeta">
              <span class="chip">BTR/NC ready</span>
              <span class="chip">47 item review</span>
            </div>
          </a>

        </div>
      </div>
    </div>

  </section>
</div>

<div class="modal" id="helpModal">
  <div class="box">
    <div class="hd">
      <b>Bantuan</b>
      <button class="iconclose" id="helpClose" type="button">✕</button>
    </div>
    <div class="bd">
      <ul class="help-list">
        <li><b>Search</b> digunakan untuk mencari kata kunci (sektor, wilayah, indikator, aksi, pembiayaan).</li>
        <li><b>Beranda</b> menampilkan ringkasan nasional dan pratinjau cepat tiap halaman.</li>
        <li><b>Sektoral</b> untuk membandingkan capaian & kualitas data per sektor.</li>
        <li><b>Kewilayahan</b> untuk melihat tren dan gap pelaporan antar wilayah.</li>
        <li><b>Impact/Outcome</b> membaca sinyal indikator (tanpa klaim kausal).</li>
        <li><b>Aksi & Pembiayaan</b> menelusuri keterkaitan aksi dan tag CBT.</li>
        <li><b>Pelaporan</b> untuk ekspor ringkasan dan audit trail.</li>
      </ul>
      <div class="footer-note">Catatan: fitur pencarian saat ini hanya menyorot & memfilter kartu di beranda (bisa kita kembangkan lintas halaman).</div>
    </div>
  </div>
</div>


<script>
  // ====== mini canvas helpers (no library) ======
  function drawLine(canvas, data, stroke="rgba(37,99,235,.90)", fill="rgba(37,99,235,.10)"){
    const ctx = canvas.getContext("2d");
    const w = canvas.width, h = canvas.height;
    ctx.clearRect(0,0,w,h);

    // bg
    ctx.fillStyle = "rgba(15,23,42,.03)";
    roundRect(ctx, 0, 0, w, h, 12); ctx.fill();

    // grid
    ctx.globalAlpha = .12;
    ctx.strokeStyle = "rgba(15,23,42,.65)";
    for(let x=20;x<w;x+=60){ctx.beginPath();ctx.moveTo(x,10);ctx.lineTo(x,h-16);ctx.stroke();}
    for(let y=10;y<h-16;y+=35){ctx.beginPath();ctx.moveTo(14,y);ctx.lineTo(w-10,y);ctx.stroke();}
    ctx.globalAlpha = 1;

    const max = Math.max(...data) * 1.15;
    const x0 = 16, y0 = h-18, iw = w-30, ih = h-34;

    // area
    ctx.beginPath();
    data.forEach((v,i)=>{
      const x = x0 + iw*(i/(data.length-1));
      const y = y0 - ih*(v/max);
      if(i===0) ctx.moveTo(x,y);
      else ctx.lineTo(x,y);
    });
    ctx.lineTo(x0+iw, y0);
    ctx.lineTo(x0, y0);
    ctx.closePath();
    ctx.fillStyle = fill;
    ctx.fill();

    // line
    ctx.beginPath();
    data.forEach((v,i)=>{
      const x = x0 + iw*(i/(data.length-1));
      const y = y0 - ih*(v/max);
      if(i===0) ctx.moveTo(x,y);
      else ctx.lineTo(x,y);
    });
    ctx.strokeStyle = stroke;
    ctx.lineWidth = 3;
    ctx.stroke();

    // dots
    ctx.fillStyle = "rgba(6,182,212,.95)";
    data.forEach((v,i)=>{
      const x = x0 + iw*(i/(data.length-1));
      const y = y0 - ih*(v/max);
      ctx.beginPath(); ctx.arc(x,y,4,0,Math.PI*2); ctx.fill();
    });
  }

  function drawBars(canvas, values){
    const ctx = canvas.getContext("2d");
    const w = canvas.width, h = canvas.height;
    ctx.clearRect(0,0,w,h);
    ctx.fillStyle = "rgba(15,23,42,.03)";
    roundRect(ctx, 0, 0, w, h, 12); ctx.fill();

    const pad = 14;
    const barW = (w - pad*2) / values.length;
    const max = Math.max(...values)*1.2;

    values.forEach((v,i)=>{
      const x = pad + i*barW + 6;
      const bh = (h-30) * (v/max);
      const y = h-16 - bh;
      ctx.fillStyle = "rgba(37,99,235,.65)";
      roundRect(ctx, x, y, barW-14, bh, 8); ctx.fill();
    });
  }

  function roundRect(ctx, x, y, w, h, r){
    const rr = Math.min(r, w/2, h/2);
    ctx.beginPath();
    ctx.moveTo(x+rr,y);
    ctx.arcTo(x+w,y,x+w,y+h,rr);
    ctx.arcTo(x+w,y+h,x,y+h,rr);
    ctx.arcTo(x,y+h,x,y,rr);
    ctx.arcTo(x,y,x+w,y,rr);
    ctx.closePath();
  }

  // ====== main trend (2 series) ======
  (function(){
    const canvas = document.getElementById("trendMain");
    const ctx = canvas.getContext("2d");
    const w = canvas.width, h = canvas.height;
    ctx.clearRect(0,0,w,h);

    // bg
    ctx.fillStyle = "rgba(37,99,235,.03)";
    roundRect(ctx, 0, 0, w, h, 14); ctx.fill();

    // grid
    ctx.globalAlpha=.12; ctx.strokeStyle="rgba(15,23,42,.55)";
    for(let x=40;x<w;x+=70){ctx.beginPath();ctx.moveTo(x,20);ctx.lineTo(x,h-40);ctx.stroke();}
    for(let y=20;y<h-40;y+=55){ctx.beginPath();ctx.moveTo(40,y);ctx.lineTo(w-20,y);ctx.stroke();}
    ctx.globalAlpha=1;

    // axes
    ctx.strokeStyle="rgba(15,23,42,.55)";
    ctx.beginPath();ctx.moveTo(40,20);ctx.lineTo(40,h-40);ctx.lineTo(w-20,h-40);ctx.stroke();

    const seriesA=[900,1100,1245];
    const seriesB=[420,520,612];
    const max=Math.max(...seriesA,...seriesB)*1.15;

    const x0=40,y0=h-40,iw=w-60,ih=h-70;

    function plot(arr, stroke){
      ctx.strokeStyle=stroke; ctx.lineWidth=3;
      ctx.beginPath();
      arr.forEach((v,i)=>{
        const x=x0+iw*(i/(arr.length-1));
        const y=y0-ih*(v/max);
        if(i===0) ctx.moveTo(x,y); else ctx.lineTo(x,y);
      });
      ctx.stroke();
    }
    plot(seriesA,"rgba(37,99,235,.92)");
    plot(seriesB,"rgba(34,197,94,.90)");
  })();

  // ====== quick previews ======
  drawBars(document.getElementById("qSektor"), [12,18,10,22,14,16]);
  drawLine(document.getElementById("qImpact"), [62,58,64,60,67,65], "rgba(168,85,247,.90)", "rgba(168,85,247,.12)");
  drawLine(document.getElementById("qFin"), [40,52,48,60,58,66], "rgba(245,158,11,.90)", "rgba(245,158,11,.12)");
  drawBars(document.getElementById("qReport"), [8,12,10,14,9,15]);
  // --- Help modal ---
  const helpBtn = document.getElementById("helpBtn");
  const helpModal = document.getElementById("helpModal");
  const helpClose = document.getElementById("helpClose");

  if(helpBtn && helpModal && helpClose){
    helpBtn.onclick = () => helpModal.style.display = "flex";
    helpClose.onclick = () => helpModal.style.display = "none";
    helpModal.addEventListener("click", (e) => {
      if(e.target === helpModal) helpModal.style.display = "none";
    });
  }

  // --- Simple search (filter Akses Cepat cards + highlight text) ---
  const search = document.getElementById("globalSearch");
  if(search){
    const cards = Array.from(document.querySelectorAll(".qcard"));
    search.addEventListener("input", () => {
      const q = search.value.trim().toLowerCase();
      cards.forEach(el => {
        const text = el.innerText.toLowerCase();
        el.style.display = (!q || text.includes(q)) ? "block" : "none";
      });
    });
  }
</script>
</body>
</html>
