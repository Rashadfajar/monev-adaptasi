<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>MoNEv Adaptasi â€“ MPC Dashboard</title>
  <link rel="stylesheet" href="app.css" />
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
  <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>

</head>
<body>
  <div class="app">
    <!-- TOP BAR -->
    <header class="topbar">
      <div class="brand">
        <div class="logo-container">
          <img src="assets/Logo_KLH.png" alt="Logo" class="logo">
        </div>
        <div class="brand-text">
          <div class="brand-title" data-i18n="appTitle">MoNEv Adaptasi â€“ MPC</div>
          <div class="brand-sub" data-i18n="appSub">Dashboard / Control Tower</div>
        </div>
        <!-- <div class="logo">MoNEv</div>
        <div class="brand-text">
          <div class="brand-title" data-i18n="appTitle">MoNEv Adaptasi â€“ MPC</div>
          <div class="brand-sub" data-i18n="appSub">Dashboard / Control Tower</div>
        </div> -->
      </div>

      <div class="search">
        <input id="globalSearch" type="search" placeholder="Cari aksi / indikator / lokasi / K/L / OPD / periodeâ€¦" />
        <select id="searchScope">
          <option value="all">All</option>
          <option value="actions">Actions</option>
          <option value="indicators">Indicators</option>
          <option value="locations">Locations</option>
          <option value="institutions">Institutions</option>
          <option value="reports">Reports</option>
          <option value="help">Help</option>
        </select>
        <button id="searchBtn" class="btn">Search</button>
      </div>

      <div class="top-actions">
        <button id="langToggle" class="chip" title="Toggle ID/EN">ID</button>
        <button class="icon-btn" title="Help">?</button>
        <button class="icon-btn" title="Notifications">ðŸ””<span id="notifBadge" class="badge">3</span></button>
        <button class="icon-btn" title="User">ðŸ‘¤</button>
      </div>
    </header>

    <!-- BODY -->
    <div class="body">
      <!-- SIDEBAR -->
      <aside class="sidebar">
        <nav class="nav">
          <a class="nav-item active" href="#" data-i18n="navDashboard">Dashboard (Home)</a>
          <a class="nav-item" href="input.html" data-i18n="navInput">Input Data</a>
          <a class="nav-item" href="review.html" data-i18n="navReview">Review & Validasi</a>
          <a class="nav-item" href="engine.html" data-i18n="navEngine">Impact Engine</a>
          <a class="nav-item" href="reporting.html" data-i18n="navReporting">Pelaporan & Ekspor</a>
          <a class="nav-item" href="help.html" data-i18n="navHelp">Help Center</a>
        </nav>

        <div class="sidebar-footer">
          <!-- <div class="small muted">v0.1 (frontend only)</div> -->
        </div>
      </aside>

      <!-- MAIN -->
      <main class="main">
        <!-- CONTROL PANEL -->
        <section class="panel">
          <div class="panel-row">
            <div class="field">
              <label data-i18n="periodActive">Periode Aktif</label>
              <div class="row">
                <select id="yearSel"></select>
                <select id="subperiodSel">
                  <option value="S1">Semester 1</option>
                  <option value="S2">Semester 2</option>
                </select>
              </div>
            </div>

            <div class="field">
              <label data-i18n="periodStatus">Status Periode</label>
              <div class="row">
                <span id="periodStatus" class="status-pill open">OPEN</span>
                <button id="lockBtn" class="btn btn-ghost" data-i18n="lockPeriod">Lock Period</button>
              </div>
            </div>

            <div class="field grow">
              <label data-i18n="quickActions">Quick Actions</label>
              <div class="row wrap">
                <a class="btn" href="input.html#horizontal" data-i18n="qaInputH">Input Horizontal</a>
                <a class="btn" href="input.html#vertical" data-i18n="qaInputV">Input Vertical</a>
                <a class="btn" href="review.html" data-i18n="qaInbox">Review Inbox</a>
                <button class="btn" id="runComputeBtn" data-i18n="qaRunCompute">Run Computation</button>
                <a class="btn" href="reporting.html" data-i18n="qaExport">Export Report</a>
              </div>
            </div>
          </div>

          <div class="panel-row">
            <div class="field grow">
              <label data-i18n="globalFilters">Global Filters</label>
              <div class="row wrap">
                <select id="sectorSel">
                  <option value="">Sector (All)</option>
                  <option value="Food">Food</option>
                  <option value="Water">Water</option>
                  <option value="Health">Health</option>
                  <option value="Ecosystems">Ecosystems</option>
                  <option value="DRM">DRM</option>
                  <option value="Coastal">Coastal</option>
                </select>
                <select id="locationSel">
                  <option value="">Location (All)</option>
                  <option value="Prov A">Prov A</option>
                  <option value="Prov B">Prov B</option>
                  <option value="Prov C">Prov C</option>
                </select>
                <select id="instSel">
                  <option value="">Institution (All)</option>
                  <option value="KLH">KLH</option>
                  <option value="KemenPU">KemenPU</option>
                  <option value="Prov A â€“ OPD">Prov A â€“ OPD</option>
                </select>
                <select id="typologySel">
                  <option value="">Typology (All)</option>
                  <option value="Infrastructure">Infrastructure</option>
                  <option value="EbA">EbA</option>
                  <option value="Capacity">Capacity</option>
                  <option value="Governance">Governance</option>
                  <option value="EWS">EWS</option>
                </select>
                <button id="resetFilters" class="btn btn-ghost" data-i18n="reset">Reset</button>
              </div>
            </div>
          </div>
        </section>

        <!-- STATUS CARDS -->
        <section class="grid-4">
          <div class="card">
            <div class="card-title" data-i18n="cardH">Horizontal Input</div>
            <div class="kpi"><span id="hSub">145</span> <span class="muted" data-i18n="submissions">submissions</span></div>
            <div class="meta">
              <div><span class="muted" data-i18n="pending">Pending</span>: <b id="hPend">18</b></div>
              <div><span class="muted" data-i18n="approved">Approved</span>: <b id="hAppr">90%</b></div>
            </div>
            <a class="link" href="input.html#horizontal" data-i18n="goInput">Go to Input â†’</a>
          </div>

          <div class="card">
            <div class="card-title" data-i18n="cardV">Vertical Input</div>
            <div class="kpi"><span id="vSub">322</span> <span class="muted" data-i18n="submissions">submissions</span></div>
            <div class="meta">
              <div><span class="muted" data-i18n="pending">Pending</span>: <b id="vPend">41</b></div>
              <div><span class="muted" data-i18n="coverage">Coverage</span>: <b id="vCov">76%</b></div>
            </div>
            <a class="link" href="input.html#vertical" data-i18n="goInput">Go to Input â†’</a>
          </div>

          <div class="card">
            <div class="card-title" data-i18n="cardQA">QA/QC Workflow</div>
            <div class="kpi"><span id="qaInbox">12</span> <span class="muted" data-i18n="inboxItems">inbox items</span></div>
            <div class="meta">
              <div><span class="muted" data-i18n="returned">Returned</span>: <b id="qaRet">5</b></div>
              <div><span class="muted" data-i18n="avgReview">Avg review</span>: <b id="qaAvg">3d</b></div>
            </div>
            <a class="link" href="review.html" data-i18n="openInbox">Open Inbox â†’</a>
          </div>

          <div class="card">
            <div class="card-title" data-i18n="cardEngine">Impact Engine</div>
            <div class="kpi"><span id="engReady">85%</span> <span class="muted" data-i18n="readiness">readiness</span></div>
            <div class="meta">
              <div><span class="muted" data-i18n="lastRun">Last run</span>: <b id="engLast">2026-03-14 10:12</b></div>
              <div><span class="muted" data-i18n="errors">Errors</span>: <b id="engErr">2</b></div>
            </div>
            <a class="link" href="engine.html" data-i18n="openEngine">Open Engine â†’</a>
          </div>
        </section>

        <section class="panel">
          <div class="panel-row" style="display: flex; justify-content: space-between; align-items: stretch; gap: 20px;">
            <!-- Peta -->
            <div class="field" style="flex: 1; padding: 10px;">
              <h3 style="color: white; margin:0 0 8px 0;">Wilayah Terlapor</h3>
              <div id="mapid" style="height: 300px; border-radius: 10px; box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);"></div>
            </div>

            <!-- Grafik Tren Aksi Adaptasi -->
            <div class="field" style="flex: 1; padding: 10px;">
              <h3 style="color: white; margin:0 0 8px 0;">Tren Aksi Adaptasi</h3>
              <!-- <div class="muted small" style="margin-bottom:8px;">Grafik mengikuti Global Filters (Sector/Location/Institution/Typology) & Periode.</div> -->
              <div id="trendWrap" style="width:100%; height: 300px;">
                <svg id="trendSvg" viewBox="0 0 720 360" preserveAspectRatio="none" role="img" aria-label="Trend chart"></svg>
              </div>
            </div>
          </div>
        </section>

        <!-- TASKS/ALERTS/LOGS + RESULTS TABS -->
        <section class="grid-2">
          <!-- Tasks/Alerts/Logs -->
          <div class="card">
            <div class="tabs">
              <button class="tab active" data-tab="tasks" data-i18n="tasks">Tasks</button>
              <button class="tab" data-tab="alerts" data-i18n="alerts">Alerts</button>
              <button class="tab" data-tab="logs" data-i18n="logs">Computation Logs</button>
            </div>

            <div class="tab-panel" id="tab-tasks">
              <ul class="list" id="tasksList"></ul>
            </div>

            <div class="tab-panel hidden" id="tab-alerts">
              <ul class="list" id="alertsList"></ul>
            </div>

            <div class="tab-panel hidden" id="tab-logs">
              <ul class="list" id="logsList"></ul>
            </div>
          </div>

          <!-- Results Workspace -->
          <div class="card">
            <div class="tabs">
              <button class="tab active" data-view="mpc" data-i18n="tabMPC">MPC View</button>
              <button class="tab" data-view="h" data-i18n="tabH">Horizontal View</button>
              <button class="tab" data-view="v" data-i18n="tabV">Vertical View</button>
              <button class="tab" data-view="impact" data-i18n="tabImpact">Impact View</button>
            </div>

            <div class="view" id="view-mpc">
              <div class="kpi-row">
                <div class="kpi-card"><div class="kpi-n" id="kpiActions">1,245</div><div class="kpi-l" data-i18n="kpiActions">Aksi validated</div></div>
                <div class="kpi-card"><div class="kpi-n" id="kpiProgress">68%</div><div class="kpi-l" data-i18n="kpiProgress">Capaian indikator</div></div>
                <div class="kpi-card"><div class="kpi-n" id="kpiReadiness">82%</div><div class="kpi-l" data-i18n="kpiReadiness">Readiness nasional</div></div>
                <div class="kpi-card"><div class="kpi-n" id="kpiCoverage">312/514</div><div class="kpi-l" data-i18n="kpiCoverage">Wilayah terlapor</div></div>
              </div>

              <div class="table-wrap">
                <table class="table" id="mpcTable">
                  <thead>
                    <tr>
                      <th data-i18n="colSector">Sektor</th>
                      <th data-i18n="colActions">#Aksi</th>
                      <th data-i18n="colApproved">%Approved</th>
                      <th data-i18n="colReadiness">Avg Readiness</th>
                      <th data-i18n="colStatus">Status</th>
                    </tr>
                  </thead>
                  <tbody></tbody>
                </table>
              </div>

              <div class="row wrap">
                <a class="btn btn-ghost" href="reporting.html" data-i18n="viewReports">View Report Packages</a>
                <button class="btn btn-ghost" id="briefBtn" data-i18n="brief">Generate Briefing Note</button>
              </div>
            </div>

            <div class="view hidden" id="view-h">
              <div class="muted" data-i18n="hHint">Tampilan ringkas sektoral/KL (mock). Klik baris untuk detail aksi.</div>
              <div class="table-wrap">
                <table class="table" id="hTable">
                  <thead>
                    <tr>
                      <th>K/L</th><th>Aksi</th><th>Sektor</th><th>Lokasi</th><th>Indikator</th><th>Target</th><th>Realisasi</th><th>Status QA</th>
                    </tr>
                  </thead>
                  <tbody></tbody>
                </table>
              </div>
              <div class="row wrap">
                <a class="btn btn-ghost" href="input.html#horizontal" data-i18n="openInputH">Open Input Horizontal</a>
                <button class="btn btn-ghost" id="dlH" data-i18n="download">Download Filtered Data</button>
              </div>
            </div>

            <div class="view hidden" id="view-v">
              <div class="muted" data-i18n="vHint">Tampilan ringkas kewilayahan (mock). Klik baris untuk detail wilayah.</div>
              <div class="table-wrap">
                <table class="table" id="vTable">
                  <thead>
                    <tr>
                      <th>Wilayah</th><th>#Aksi</th><th>#Ind</th><th>Readiness</th><th>Pending</th><th>Last Update</th>
                    </tr>
                  </thead>
                  <tbody></tbody>
                </table>
              </div>
              <div class="row wrap">
                <a class="btn btn-ghost" href="input.html#vertical" data-i18n="openInputV">Open Input Vertical</a>
                <a class="btn btn-ghost" href="review.html" data-i18n="openInbox2">Open Review Inbox</a>
              </div>
            </div>

            <div class="view hidden" id="view-impact">
              <div class="muted" data-i18n="impactHint">Output komputasi (mock). Klik baris untuk lineage.</div>
              <div class="table-wrap">
                <table class="table" id="impactTable">
                  <thead>
                    <tr>
                      <th>Domain</th><th>Indicator Group</th><th>Value</th><th>Trend</th><th>Coverage</th><th>Confidence</th>
                    </tr>
                  </thead>
                  <tbody></tbody>
                </table>
              </div>
              <div class="row wrap">
                <button class="btn btn-ghost" id="runComputeBtn2" data-i18n="qaRunCompute">Run Computation</button>
                <a class="btn btn-ghost" href="engine.html" data-i18n="viewLogs">View Logs</a>
              </div>
            </div>

          </div>
        </section>

        <!-- MODAL: Search Results -->
        <div class="modal hidden" id="searchModal" role="dialog" aria-modal="true">
          <div class="modal-card">
            <div class="modal-head">
              <div class="modal-title" id="searchTitle">Search Results</div>
              <button class="icon-btn" id="closeSearch">âœ•</button>
            </div>
            <div class="modal-body" id="searchBody"></div>
          </div>
        </div>

        <!-- MODAL: Lineage / Info -->
        <div class="modal hidden" id="infoModal" role="dialog" aria-modal="true">
            <div class="modal-card">
              <div class="modal-head">
                <div class="modal-title" id="infoTitle">Details</div>
                <button class="icon-btn" id="closeInfo">âœ•</button>
              </div>
              <div class="modal-body" id="infoBody"></div>
            </div>
        </div>
      </main>
    </div>
  </div>

  <script src="app.js"></script>
</body>
</html>
